#!/usr/bin/env bash

# rofi brightness menu

get_brightness() {
    brightnessctl g
}

get_max() {
    brightnessctl m
}

get_percent() {
    current=$(get_brightness)
    max=$(get_max)
    printf "%.0f\n" "$(( 100 * current / max ))"
}

inc_brightness() {
    brightnessctl set 5%+ >/dev/null
}

dec_brightness() {
    brightnessctl set 5%- >/dev/null
}

set_brightness() {
    value="$1"
    brightnessctl set "${value}%" >/dev/null
}

# Build menu
percent=$(get_percent)
options="🔆 Increase (+5%)\n🔅 Decrease (-5%)\n⏺ Set value...\n📊 Current: ${percent}%"

chosen=$(echo -e "$options" | rofi -dmenu -p "Brightness" -i)

case "$chosen" in
    "🔆 Increase (+5%)") inc_brightness ;;
    "🔅 Decrease (-5%)") dec_brightness ;;
    "⏺ Set value...") 
        value=$(rofi -dmenu -p "Set Brightness (0-100)")
        [[ "$value" =~ ^[0-9]+$ ]] && set_brightness "$value"
        ;;
esac

